<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<ui:composition template="/applayout/pageTemplate.xhtml" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:b="http://bootsfaces.net/ui"
                xmlns:o="http://omnifaces.org/ui"
                xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://java.sun.com/jsf/facelets">

    <ui:define name="custom-header">
        <f:metadata>
            <o:viewParam name="officeTypeId" value="#{officeTypeHome.id}"/>
        </f:metadata>
    </ui:define>


    <b:row style="margin-top: 20px;">
        <b:column colMd="3">
            <o:form id="officeTypes" includeViewParams="true">
                <nav class="menu">

                    <div class="menu-heading">
                        营业类型
                    </div>

                    <ui:repeat value="#{officeTypeManager.officeTypes}" var="_type">
                        <p:commandLink ajax="true" immediate="true"
                                       styleClass="menu-item #{officeTypeHome.id eq _type.id ? 'selected' : ''}"
                                       update="officeTypes,officeTypeDetails,jobList" process="@this"
                                       style="#{_type.enable ? '' : 'text-decoration:line-through;'}"
                                       value="#{_type.name}">
                            <f:setPropertyActionListener value="#{_type.id}" target="#{officeTypeHome.id}"/>
                        </p:commandLink>
                    </ui:repeat>

                    <p:commandLink ajax="true" immediate="true"
                                   styleClass="menu-item #{officeTypeHome.idDefined ? '' : 'selected'}"
                                   update="officeTypes,officeTypeDetails,jobList" process="@this"
                                   value="新增一个类型">
                        <f:setPropertyActionListener value="" target="#{officeTypeHome.id}"/>
                    </p:commandLink>
                </nav>
            </o:form>
        </b:column>
        <b:column colMd="9">

            <o:form id="officeTypeDetails" includeViewParams="true">
                <b:panel collapsible="false" title="类型设置" titleClass="header-sm">


                    <b:row>
                        <b:column colSm="4" colMd="4">
                            <b:switch value="#{officeTypeHome.instance.store}" label="仓库" renderLabel="false"
                                      on-text="可仓储" off-text="无仓库"/>
                        </b:column>

                        <b:column colSm="4" colMd="4">
                            <b:switch value="#{officeTypeHome.instance.sale}" label="销售" renderLabel="false"
                                      on-text="可销售" off-text="无销售"/>
                        </b:column>

                        <b:column colSm="4" colMd="4">
                            <b:switch value="#{officeTypeHome.instance.produce}" label="生产" renderLabel="false"
                                      on-text="可生产" off-text="无生产"/>
                        </b:column>

                    </b:row>

                    <span class="input-group-append">

<b:inputText value="#{officeTypeHome.instance.name}" label="名称" renderLabel="true">
    <f:facet name="append">
        <b:switch value="#{officeTypeHome.instance.enable}"
                  off-text="禁用" on-text="启用"/>
    </f:facet>
</b:inputText>
                        <b:message/>
</span>

                    <b:commandButton look="success" style="margin-top: 14px" action="#{officeTypeHome.saveOrUpdate}" value="保存">

                    </b:commandButton>


                </b:panel>
            </o:form>
            <o:form id="jobList" includeViewParams="true">

            <b:panel rendered="#{officeTypeHome.idDefined}" collapsible="false" title="岗位" titleClass="header-sm">
                <ui:repeat value="#{officeTypeHome.jobs}" var="_job">
                    <b:inputText disabled="#{not _job.enable}" value="#{_job.name}">

                        <f:facet name="prepend">


                            <h:selectBooleanCheckbox value="#{_job.enable}">
                                <f:ajax execute="@this" listener="#{officeTypeHome.saveOrUpdate}" render="jobList"/>
                            </h:selectBooleanCheckbox>
                        </f:facet>
                        <f:facet name="append">


                            <b:commandButton disabled="#{not _job.enable}" iconAwesome="save" ajax="true" process="@parent"
                                             action="#{officeTypeHome.saveOrUpdate}" update="@parent"/>

                            <b:commandButton iconAwesome="arrow-up" ajax="true" process="@this" action="#{officeTypeHome.upJob}" update="jobList">
                                    <f:setPropertyActionListener value="#{_job.id}" target="#{officeTypeHome.selectJobId}"/>
                            </b:commandButton>

                            <b:commandButton iconAwesome="arrow-down" ajax="true" process="@this" action="#{officeTypeHome.downJob}" update="jobList">
                                <f:setPropertyActionListener value="#{_job.id}" target="#{officeTypeHome.selectJobId}"/>
                            </b:commandButton>
                        </f:facet>
                    </b:inputText>
                    <b:message/>
                </ui:repeat>


                <b:inputText value="#{officeTypeHome.newJobName}" label="岗位名称" renderLabel="false"
                             required="true" placeholder="增加一个新的岗位">
                    <f:facet name="append">
                        <b:commandButton look="success" ajax="true" iconAwesome="plus"
                                         process="@parent" update="jobList" action="#{officeTypeHome.addJob}" />
                    </f:facet>
                </b:inputText>
                <b:message/>
            </b:panel>


        </o:form>

    </b:column>

</b:row>


        </ui:composition>